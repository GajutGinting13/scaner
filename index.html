<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Code Scanner</title>
  <!-- Sertakan library Instascan -->
  <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
</head>
<body>
  <!-- Container untuk menampilkan video dari kamera -->
  <div id="camera-container"></div>

  <!-- Container untuk menampilkan hasil pemindaian QR code -->
  <div id="result-container">
    <p id="result-text"></p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const scanner = new Instascan.Scanner({ video: document.getElementById('camera-container') });
      const resultTextElement = document.getElementById('result-text');

      // Event handler ketika QR code terdeteksi
      scanner.addListener('scan', (content) => {
        resultTextElement.textContent = 'QR Code detected: ' + content;
      });

      // Mengaktifkan kamera belakang
      Instascan.Camera.getCameras()
        .then((cameras) => {
          if (cameras.length > 0) {
            scanner.start(cameras[0]); // Menggunakan kamera pertama
          } else {
            console.error('No cameras found.');
          }
        })
        .catch((error) => {
          console.error('Error accessing camera:', error);
        });

      // Fungsi untuk menghentikan pemindaian ketika halaman ditutup
      function stopScanner() {
        scanner.stop();
      }

      // Panggil fungsi stopScanner() saat proyek selesai atau dihentikan
      // Misalnya: window.addEventListener('unload', stopScanner);
    });
  </script>
</body>
</html>
